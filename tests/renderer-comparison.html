<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>

  <title>Scenery Rendering Renderer Comparison</title>
  
  <!-- jQuery and LoDash are dependencies -->
  <script src="../contrib/jquery-1.8.3.min.js"></script>
  <script src="../contrib/lodash.min-1.0.0-rc.3.js"></script>
  <script src="../contrib/has.js"></script>
  
  <!-- Our code, in either the concatenated 'with comments' version or the minified version -->
  <script data-main="../js/config.js" src="../contrib/require-2.1.4.js"></script>
  <!-- <script src="../dist/standalone/scenery.js"></script> -->
  <!-- <script src="../dist/standalone/scenery.min.js"></script> -->
  
  <style type="text/css">
    .testname {
      clear: both;
      margin: 0;
      padding: 0;
      padding-top: 20px;
      padding-bottom: 5px;
    }
    
    .scene {
      float: left;
      margin-left: 5px;
      position: relative; /* trigger correct positioning inside the scene */
      background-color: #fff;
      z-index: 0;
      padding: none !important; /* in case we add jQuery Mobile back in */
      border: 1px solid black;
    }
    
    .scene.canvas:after {
      content: "Canvas";
      position: absolute;
      bottom: 0;
      left: 2px;
      opacity: 0.3;
    }
    
    .scene.svg:after {
      content: "SVG";
      position: absolute;
      bottom: 0;
      left: 2px;
      opacity: 0.3;
    }

  </style>
</head>

<body>
  
  <h1>Scenery Rendering Renderer Comparison</h1>
  
  <script>
  
  require( [ 'main', '../common/dot/js/main' ], function( scenery, dot ) {
    var testCases = [
      {
        name: 'Rectangle',
        width: 64,
        height: 64,
        draw: function( scene ) {
          scene.addChild( new scenery.Path( {
            shape: scenery.Shape.rectangle( 0, 0, 44, 44 ),
            x: 10.5,
            y: 10.5,
            fill: '#ff0000',
            stroke: '#000000',
            lineWidth: 3
          } ) );
        }
      },{
        name: 'Hexagon',
        width: 64,
        height: 64,
        draw: function( scene ) {
          scene.addChild( new scenery.Path( {
            shape: scenery.Shape.regularPolygon( 6, 22 ),
            x: 32,
            y: 32,
            fill: '#ff0000',
            stroke: '#000000',
            lineWidth: 3
          } ) );
        }
      },{
        name: 'RGBA',
        width: 64,
        height: 64,
        draw: function( scene ) {
          scene.addChild( new scenery.Path( {
            shape: scenery.Shape.rectangle( 32, 0, 32, 64 ),
            fill: '#000000'
          } ) );
          scene.addChild( new scenery.Path( {
            shape: scenery.Shape.rectangle( 0, 0, 44, 44 ),
            x: 10.5,
            y: 10.5,
            fill: 'rgba(255,0,0,0.5)',
            stroke: '#000000',
            lineWidth: 3
          } ) );
        }
      },{
        name: 'Overlapping and Nested Rotations',
        width: 128,
        height: 128,
        draw: function( scene ) {
          var container = new scenery.Node( {
            x: 40,
            rotation: Math.PI / 12
          } );
          scene.addChild( container );
          
          container.addChild( new scenery.Path( {
            shape: scenery.Shape.rectangle( 0, 0, 44, 44 ),
            x: 10.5,
            y: 10.5,
            rotation: Math.PI / 4,
            fill: '#ff0000',
            stroke: '#000000',
            lineWidth: 3
          } ) );
          
          container.addChild( new scenery.Path( {
            shape: scenery.Shape.rectangle( 0, 0, 44, 44 ),
            x: 30.5,
            y: 10.5,
            fill: '#ff0000',
            stroke: '#000000',
            // lineJoin: 'round',
            lineWidth: 10
          } ) );
        }
      },{
        name: 'DAG support',
        width: 256,
        height: 128,
        draw: function( scene ) {
          var square = new scenery.Path( {
            shape: scenery.Shape.rectangle( 0, 0, 50, 50 ),
            x: 0.5,
            y: 0.5,
            fill: 'rgba(0,0,0,0.5)',
            stroke: '#000000',
            lineWidth: 3
          } );
          
          var arrow = new scenery.Path( {
            shape: scenery.Shape.regularPolygon( 3, 10 ),
            fill: 'rgba(0,255,0,1)',
            stroke: '#000000'
          } );
          
          var combined = new scenery.Node();
          combined.addChild( square );
          var leftArrow = new scenery.Node( { x: 15, y: 25 } );
          leftArrow.addChild( arrow );
          combined.addChild( leftArrow );
          var rightArrow = new scenery.Node( { x: 35, y: 25 } );
          rightArrow.addChild( arrow );
          combined.addChild( rightArrow );
          
          var a = new scenery.Node( { x: 20, y: 20 } );
          a.addChild( combined );
          var b = new scenery.Node( { x: 120, y: 30, rotation: Math.PI / 4 } );
          b.addChild( combined );
          var c = new scenery.Node( { x: 220, y: 40, rotation: Math.PI / 2 } );
          c.addChild( combined );
          scene.addChild( a );
          scene.addChild( b );
          scene.addChild( c );
        }
      },{
        name: 'Text',
        width: 256,
        height: 128,
        draw: function( scene ) {
          scene.addChild( new scenery.Text( 'Is this a test?', {
            fontSize: 60,
            top: 1.5,
            left: 1.5
          } ) );
        }
      },{
        name: 'Circles and Arcs',
        width: 200,
        height: 64,
        draw: function( scene ) {
          var x = 32;
          scene.addChild( new scenery.Path( {
            shape: scenery.Shape.circle( x, 25, 20 ),
            fill: '#ff0000',
            stroke: '#000000',
            lineWidth: 3
          } ) );
          
          x += 64;
          scene.addChild( new scenery.Path( {
            shape: scenery.Shape.arc( x, 25, 20, Math.PI / 4, Math.PI * 3 / 2, false ),
            fill: 'rgba(255,0,0,0.5)',
            stroke: '#aa0000',
            lineWidth: 3
          } ) );
          
          scene.addChild( new scenery.Path( {
            shape: scenery.Shape.arc( x, 25, 20, Math.PI / 4, Math.PI * 3 / 2, true ),
            fill: 'rgba(0,0,255,0.5)',
            stroke: '#0000aa',
            lineWidth: 3
          } ) );
          
          x += 64;
          scene.addChild( new scenery.Path( {
            x: x,
            y: 25.5,
            shape: new scenery.Shape()
              .moveTo( 0, 0 )
              .arc( 0, 0, 20, 0, Math.PI / 3, false )
              .arc( 0, 0, 20, Math.PI / 3 + Math.PI, Math.PI, true )
              .close(),
            fill: '#ff0000',
            stroke: '#000000',
            lineWidth: 3
          } ) );
        }
      }
    ];
    
    var renderers = [
      scenery.Renderer.Canvas,
      scenery.Renderer.SVG
      // TODO: add WebGL, and possibly DOM for things like text?
    ];
    
    _.each( testCases, function( testCase ) {
      var $testTitle = $( document.createElement( 'h2' ) );
      $testTitle.text( testCase.name );
      $testTitle.addClass( 'testname' );
      $( document.body ).append( $testTitle );
      
      _.each( renderers, function( renderer ) {
        var layerType = renderer.defaultLayerType;
        var $container = $( document.createElement( 'div' ) );
        $container.addClass( 'scene' );
        $container.addClass( layerType.name );
        $container.width( testCase.width || 320 );
        $container.height( testCase.height || 240 );
        $( document.body ).append( $container );
        
        var scene = new scenery.Scene( $container, {
          preferredSceneLayerType: layerType
        } );
        
        try {
          testCase.draw( scene );
        } catch( e ) {
          if ( console.log ) {
            console.log( 'error encountered in test ' + testCase.name + ' with ' + layerType.name );
          }
          throw e;
        }
        scene.updateScene();
      } );
    } );
  } );

  </script>

</body>
</html>
