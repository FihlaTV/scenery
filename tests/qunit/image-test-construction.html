<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  <title>Image Test Construction</title>
  
  <!-- jQuery and LoDash are dependencies -->
  <script src="../../contrib/jquery-1.8.3.min.js"></script>
  <script src="../../contrib/lodash.min-1.0.0-rc.3.js"></script>
  <script src="../../contrib/has.js"></script>
  <script src="js/test-utils.js"></script>
  
  <!-- Our code, in either the concatenated 'with comments' version or the minified version -->
  <script data-main="../../js/config.js" src="../../contrib/require-2.1.4.js"></script>
  <!-- <script src="../dist/development/scenery.js"></script> -->
  <!-- <script src="../dist/standalone/scenery.min.js"></script> -->
</head>

<body>
  
  <script>
  
  require( [ 'main', '../common/kite/js/main', '../common/dot/js/main' ], function( scenery, kite, dot ) {
    var width = 32;
    var height = 32;
    
    var div = document.createElement( 'div' );
    var $div = $( div );
    $div.width( width );
    $div.height( height );
    document.body.appendChild( div );
    
    var scene = new scenery.Scene( $div );
    
    var shape = kite.Shape.rectangle( 0, 0, 30, 30 );
    var rect = new scenery.Path( {
      shape: shape,
      fill: '#000',
      stroke: '#f00',
      lineWidth: 2
    } );
    scene.addChild( new scenery.Node( {
      children: [ rect ],
      x: -10, y: -10
    } ) );
    scene.addChild( new scenery.Node( {
      children: [ rect ],
      x: 10, y: 10,
      visible: false
    } ) );
    scene.addChild( new scenery.Node( {
      children: [ rect ],
      x: 20, y: 20
    } ) );
    
    scene.updateScene();
    
    (function(){
      var canvas = document.createElement( 'canvas' );
      canvas.width = width;
      canvas.height = height;
      var context = canvas.getContext( '2d' );
      scene.renderToCanvas( canvas, context, function() {
        var dataURL = canvas.toDataURL();
        console.log( dataURL );
        console.log( 'length: ' + dataURL.length );
        document.body.appendChild( canvas );
      } );
    })();
  } );
  
  </script>

</body>
</html>
