<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Scenery Playground</title>
  
  <script src="../contrib/jquery-1.8.3.min.js"></script>
  <script src="../contrib/lodash.min-1.0.0-rc.3.js"></script>
  <script src="../contrib/has.js"></script>
  
  <script data-main="../js/config.js" src="../contrib/require-2.1.4.js"></script>
  
  <style>
    html, body {
      background-color: #eee;
      border: 0;
      padding: 0;
    }
    
    #scene {
      position: absolute;
      width: 512px;
      height: 256px;
      background-color: #fff;
    }
    
    #debug {
      position: relative;
      top: 256px;
      
    }
  </style>
  
</head>
<body>
  
  <div id="scene"></div>
  
  <div id="debug"></div>
  
  <script>
    // we need to wait until our config file is loaded before our require statement. apparently this was not guaranteed
    function check() {
      if ( window.loadedSceneryConfig ) {
        requirejs( [ 'main', 'KITE/main', 'DOT/main', 'PHET_CORE/main' ], function( scenery, kite, dot, core ) {
          window.scenery = scenery;
          window.kite = kite;
          window.dot = dot;
          window.core = core;
          
          console.log( 'loaded' );
          
          window.scene = new scenery.Scene( $( '#scene' ) );
          console.log( 'window.scene created' );
          
          window.shape = kite.Shape.rectangle( 0, 0, 50, 40 );
          
          core.loadScript( {
            src: 'qunit/js/test-utils.js',
            callback: function() {
              console.log( 'loaded test-utils.js' );
            }
          } );
          
          scenery.Util.polyfillRequestAnimationFrame();
          
          (function step(){
            window.requestAnimationFrame( step, document.getElementById( 'scene' ) );
            
            $( '#debug' ).html( scene.getDebugHTML() );
          })();
          
          window.twrap = function( f ) {
            try {
              f();
            } catch( e ) {
              console.log( e.stack );
            }
          };
          
          window.runError = function() {
            window.path1 = new scenery.Path( { shape: shape, fill: '#f00' } );
            window.path2 = new scenery.Path( { shape: shape, fill: '#0f0', y: 70 } );
            window.path3 = new scenery.Path( { shape: shape, fill: '#00f', x: 70, y: 140 } );
            
            window.node = new scenery.Node();
            
            scene.addChild( path1 );
            scene.addChild( path2 );
            path1.addChild( path3 );
            
            // scene.addChild( path3 );
            
            // scene.addChild( node );
            // scene.updateScene();
            // scene.removeChild( node );
            // scene.addChild( path1 );
            // scene.addChild( path2 );
            // scene.addChild( path3 ); // should be canvas, but right now is SVG!
            
            // scene.updateScene();
          };
        } );
      } else {
        setTimeout( check, 4 );
      }
    }
    setTimeout( check, 4 );
  </script>
</body>
</html>
